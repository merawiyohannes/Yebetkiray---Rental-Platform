<!-- messaging/templates/messaging/notification_dropdown.html -->
<div class="notification-dropdown absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-xl shadow-2xl border border-gray-200 hidden z-50">
    <div class="p-4 border-b border-gray-200">
        <div class="flex justify-between items-center">
            <h3 class="font-bold text-gray-900 text-sm sm:text-base">Notifications</h3>
            {% if notifications %}
            <button onclick="markAllNotificationsAsRead()" 
                    class="text-xs sm:text-sm text-primary hover:underline whitespace-nowrap">
                Mark all as read
            </button>
            {% endif %}
        </div>
    </div>
    
    <div class="max-h-64 sm:max-h-96 overflow-y-auto">
        {% for notif in notifications %}
        <a href="{{ notif.get_link|default:'#' }}" 
           class="block p-3 sm:p-4 hover:bg-gray-100 border-b border-gray-400 notification-item {% if not notif.is_read %}bg-blue-100 {% endif %}"
           data-notification-id="{{ notif.id }}"
           onclick="markNotificationAsRead({{ notif.id }})">
           
            <div class="flex items-start">
                <!-- Notification Icon - Responsive size -->
                <div class="mr-2 sm:mr-3 mt-0.5 sm:mt-1 flex-shrink-0">
                    {% if notif.notification_type == 'message' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-blue-100 flex items-center justify-center">
                        <i class="fas fa-envelope text-blue-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'verification' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-green-100 flex items-center justify-center">
                        <i class="fas fa-check-circle text-green-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'rejection' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-red-100 flex items-center justify-center">
                        <i class="fas fa-times-circle text-red-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'property_submission' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-blue-100 flex items-center justify-center">
                        <i class="fas fa-file-upload text-blue-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'property_resubmission' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-orange-100 flex items-center justify-center">
                        <i class="fas fa-redo text-orange-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'new_user' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-green-100 flex items-center justify-center">
                        <i class="fas fa-user-plus text-green-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'property_saved' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-pink-100 flex items-center justify-center">
                        <i class="fas fa-heart text-pink-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'property_view' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-purple-100 flex items-center justify-center">
                        <i class="fas fa-eye text-purple-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'property_inquiry' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-yellow-100 flex items-center justify-center">
                        <i class="fas fa-question-circle text-yellow-600 text-xs sm:text-sm"></i>
                    </div>
                    {% elif notif.notification_type == 'welcome' %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-indigo-100 flex items-center justify-center">
                        <i class="fas fa-hand-wave text-indigo-600 text-xs sm:text-sm"></i>
                    </div>
                    {% else %}
                    <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gray-100 flex items-center justify-center">
                        <i class="fas fa-bell text-gray-600 text-xs sm:text-sm"></i>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Notification Content -->
                <div class="flex-1 min-w-0">
                    <div class="flex justify-between items-start mb-1">
                        <span class="font-medium text-gray-900 text-xs sm:text-sm truncate mr-2">
                            {{ notif.get_notification_type_display }}
                        </span>
                        <span class="text-xs text-gray-500 whitespace-nowrap flex-shrink-0">
                            {{ notif.created_at|timesince }} ago
                        </span>
                    </div>
                    <p class="text-xs sm:text-sm text-gray-600 line-clamp-2">
                        {{ notif.message }}
                    </p>
                    
                    {% if not notif.is_read %}
                    <div class="dot_indicator inline-block w-1.5 h-1.5 sm:w-2 sm:h-2 bg-blue-500 rounded-full mt-1.5 sm:mt-2"></div>
                    {% endif %}
                </div>
            </div>
        </a>
        {% empty %}
        <div class="p-6 sm:p-8 text-center">
            <div class="text-3xl sm:text-4xl text-gray-300 mb-2 sm:mb-3">ðŸ””</div>
            <p class="text-gray-600 text-sm sm:text-base">No notifications yet</p>
            <p class="text-gray-500 text-xs sm:text-sm mt-1">Updates will appear here</p>
        </div>
        {% endfor %}
    </div>
    
    <div class="p-3 sm:p-4 border-t border-gray-200 text-center">
        <p class="text-primary text-xs sm:text-sm font-medium">
            View all notifications in your dashboard
        </p>
    </div>
</div>

<style>
/* Line clamp utility for truncating text */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Responsive adjustments */
@media (max-width: 640px) {
    .notification-dropdown {
        position: fixed;
        top: 60px;
        right: 10px;
        left: 10px;
        width: auto;
        max-width: calc(100vw - 20px);
        margin: 0;
    }
}

@media (max-width: 480px) {
    .notification-dropdown {
        max-height: 70vh;
    }
}
</style>